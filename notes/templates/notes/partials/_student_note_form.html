{% load django_bootstrap5 %}

<div class="card">
    <div class="card-header">
        <h6 class="mb-0">{{ action }} Note for {{ student.full_name }}</h6>
    </div>
    <div class="card-body">
        <form hx-post="{% if note %}{% url 'notes:student_note_edit' student.id note.id %}{% else %}{% url 'notes:student_note_create' student.id %}{% endif %}" 
              hx-target="#student-notes" 
              hx-swap="innerHTML">
            {% csrf_token %}
            
            <div class="mb-3">
                {% bootstrap_field form.title %}
            </div>
            
            <div class="mb-3">
                {% bootstrap_field form.body %}
            </div>
            
            <div class="mb-3">
                <label class="form-label">{{ form.visibility_scope.label }}</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="visibility_scope" id="private_staff" value="private_staff" 
                           {% if form.visibility_scope.value == 'private_staff' or not form.visibility_scope.value %}checked{% endif %}>
                    <label class="form-check-label" for="private_staff">
                        <span class="badge bg-secondary me-2">Staff-only</span>
                        Private to staff members only
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="visibility_scope" id="public_parent" value="public_parent"
                           {% if form.visibility_scope.value == 'public_parent' %}checked{% endif %}>
                    <label class="form-check-label" for="public_parent">
                        <span class="badge bg-success me-2">Parent-visible</span>
                        Visible to parent
                    </label>
                </div>
                <small class="form-text text-muted">{{ form.visibility_scope.help_text }}</small>
            </div>
            
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> {{ action }} Note
                </button>
                <button type="button" class="btn btn-secondary" 
                        hx-get="{% url 'notes:student_notes_list' student.id %}" 
                        hx-target="#student-notes" 
                        hx-swap="innerHTML">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>
