{% if messages %}
<div class="messages mb-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

<div class="mb-4">
    <h4>Current Roles</h4>
    <div class="d-flex flex-wrap gap-2">
        {% for role in user_roles %}
        <div class="d-flex align-items-center">
            <span class="badge {% if role.name == 'Admin' %}bg-danger{% else %}bg-primary{% endif %} me-2">
                {{ role.name }}
                {% if role.name == 'Admin' %}
                <i class="bi bi-shield-lock-fill ms-1"></i>
                {% endif %}
            </span>
            {% if role.name != 'Admin' or user_roles|length > 1 %}
            <form method="post" 
                  hx-post="{% url 'accounts:user_role_update' user.pk %}"
                  hx-target="#user-roles-section"
                  class="d-inline">
                {% csrf_token %}
                <input type="hidden" name="role_id" value="{{ role.id }}">
                <input type="hidden" name="action" value="remove">
                <button type="submit" class="btn btn-sm btn-outline-danger">
                    <i class="bi bi-x"></i>
                </button>
            </form>
            {% endif %}
        </div>
        {% empty %}
        <p class="text-muted">No roles assigned</p>
        {% endfor %}
    </div>
</div>

<div>
    <h4>Available Roles</h4>
    <div class="d-flex flex-wrap gap-2">
        {% for role in available_roles %}
        {% if role not in user_roles %}
        <div class="d-flex align-items-center">
            <span class="badge {% if role.name == 'Admin' %}bg-danger{% else %}bg-secondary{% endif %} me-2">
                {{ role.name }}
                {% if role.name == 'Admin' %}
                <i class="bi bi-shield-lock-fill ms-1"></i>
                {% endif %}
            </span>
            <form method="post" 
                  hx-post="{% url 'accounts:user_role_update' user.pk %}"
                  hx-target="#user-roles-section"
                  class="d-inline">
                {% csrf_token %}
                <input type="hidden" name="role_id" value="{{ role.id }}">
                <input type="hidden" name="action" value="add">
                <button type="submit" class="btn btn-sm btn-outline-success">
                    <i class="bi bi-plus"></i>
                </button>
            </form>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div> 