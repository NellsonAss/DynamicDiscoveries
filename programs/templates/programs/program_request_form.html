{% extends "base.html" %}
{% load static %}

{% block title %}Request {{ program_type.name }} - Programs{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'programs:program_catalog' %}">Program Catalog</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Request {{ program_type.name }}</li>
                </ol>
            </nav>

            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">
                        <i class="bi bi-plus-circle"></i> Request Program: {{ program_type.name }}
                    </h4>
                </div>
                <div class="card-body">
                    <!-- Program Information -->
                    <div class="alert alert-info">
                        <h6><i class="bi bi-info-circle"></i> About This Program</h6>
                        <p class="mb-0">{{ program_type.description }}</p>
                    </div>

                    <!-- Request Form -->
                    <form method="post" action="{% url 'programs:program_request_create' program_type.id %}">
                        {% csrf_token %}
                        
                        <!-- Request Type -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.request_type.id_for_label }}" class="form-label">Request Type <span class="text-danger">*</span></label>
                                {{ form.request_type }}
                                {% if form.request_type.errors %}
                                    <div class="invalid-feedback d-block">{{ form.request_type.errors.0 }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <h6 class="text-primary mb-3"><i class="bi bi-person"></i> Contact Information</h6>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.contact_name.id_for_label }}" class="form-label">Your Name <span class="text-danger">*</span></label>
                                {{ form.contact_name }}
                                {% if form.contact_name.errors %}
                                    <div class="invalid-feedback d-block">{{ form.contact_name.errors.0 }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.contact_email.id_for_label }}" class="form-label">Email Address <span class="text-danger">*</span></label>
                                {{ form.contact_email }}
                                {% if form.contact_email.errors %}
                                    <div class="invalid-feedback d-block">{{ form.contact_email.errors.0 }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.contact_phone.id_for_label }}" class="form-label">Phone Number</label>
                                {{ form.contact_phone }}
                                {% if form.contact_phone.errors %}
                                    <div class="invalid-feedback d-block">{{ form.contact_phone.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text">Optional, but helpful for follow-up questions</div>
                            </div>
                        </div>

                        <!-- Program Details -->
                        <h6 class="text-primary mb-3"><i class="bi bi-calendar-event"></i> Program Details</h6>
                        
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <label for="{{ form.preferred_location.id_for_label }}" class="form-label">Preferred Location</label>
                                {{ form.preferred_location }}
                                {% if form.preferred_location.errors %}
                                    <div class="invalid-feedback d-block">{{ form.preferred_location.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text">Where would you like this program to be offered?</div>
                            </div>
                            <div class="col-md-4">
                                <label for="{{ form.expected_participants.id_for_label }}" class="form-label">Expected Participants</label>
                                {{ form.expected_participants }}
                                {% if form.expected_participants.errors %}
                                    <div class="invalid-feedback d-block">{{ form.expected_participants.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text">Approximate number</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.preferred_dates.id_for_label }}" class="form-label">Preferred Dates/Times</label>
                            {{ form.preferred_dates }}
                            {% if form.preferred_dates.errors %}
                                <div class="invalid-feedback d-block">{{ form.preferred_dates.errors.0 }}</div>
                            {% endif %}
                            <div class="form-text">{{ form.preferred_dates.help_text }}</div>
                        </div>

                        <!-- Contractor-Specific Fields -->
                        <div id="contractor-fields" style="display: none;">
                            <h6 class="text-info mb-3"><i class="bi bi-briefcase"></i> Contractor Information</h6>
                            
                            <div class="mb-3">
                                <label for="{{ form.proposed_location.id_for_label }}" class="form-label">Proposed Location <span class="text-danger">*</span></label>
                                {{ form.proposed_location }}
                                {% if form.proposed_location.errors %}
                                    <div class="invalid-feedback d-block">{{ form.proposed_location.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text">{{ form.proposed_location.help_text }}</div>
                            </div>

                            <div class="mb-3">
                                <label for="{{ form.contractor_experience.id_for_label }}" class="form-label">Your Experience <span class="text-danger">*</span></label>
                                {{ form.contractor_experience }}
                                {% if form.contractor_experience.errors %}
                                    <div class="invalid-feedback d-block">{{ form.contractor_experience.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text">{{ form.contractor_experience.help_text }}</div>
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <h6 class="text-primary mb-3"><i class="bi bi-chat-text"></i> Additional Information</h6>
                        
                        <div class="mb-3">
                            <label for="{{ form.additional_notes.id_for_label }}" class="form-label">Additional Notes</label>
                            {{ form.additional_notes }}
                            {% if form.additional_notes.errors %}
                                <div class="invalid-feedback d-block">{{ form.additional_notes.errors.0 }}</div>
                            {% endif %}
                            <div class="form-text">Any special requirements, accommodations, or additional information</div>
                        </div>

                        <!-- What Happens Next -->
                        <div class="alert alert-success">
                            <h6><i class="bi bi-check-circle"></i> What Happens Next?</h6>
                            <ul class="mb-0 small">
                                <li>Your request will be reviewed by our program coordinators</li>
                                <li>We'll contact you within 2-3 business days to discuss details</li>
                                <li>If approved, we'll work with you to schedule the program</li>
                                <li>You'll receive updates via email throughout the process</li>
                            </ul>
                        </div>

                        <!-- Form Actions -->
                        <div class="d-flex justify-content-between">
                            <a href="{% url 'programs:program_catalog' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left"></i> Back to Catalog
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-send"></i> Submit Request
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const requestTypeSelect = document.getElementById('{{ form.request_type.id_for_label }}');
    const contractorFields = document.getElementById('contractor-fields');
    
    function toggleContractorFields() {
        if (requestTypeSelect.value === 'contractor_buildout') {
            contractorFields.style.display = 'block';
        } else {
            contractorFields.style.display = 'none';
        }
    }
    
    // Initial check
    toggleContractorFields();
    
    // Listen for changes
    requestTypeSelect.addEventListener('change', toggleContractorFields);
});
</script>
{% endblock %}
